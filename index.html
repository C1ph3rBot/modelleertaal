<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Modelleertaal test webpagina</title>

	<style>
    html {
      font-family: Helvetica, Arial, sans-serif;
      font-size: 100%;
    }
    /* schaduw rand om werkblad zodat afmetinging zichtbaar is
       handig voor debuggen */
    #werkBlad {
      padding: 1em;
      margin: 1em auto;
      box-shadow: 0 2px 10px rgba(0,0,0,0.8);
    }


    </style>
    <script src="jquery-1.11.3.js"></script>
</head>
<body>
	<div id="werkBlad"> <!-- CSS zorg voor met werkvlak met schaduw -->
        <h2>Modeltest</h2>

        <div>
            <input id="open" type="button" value= "Open model.xml via HTTP/get">
			<p>
            <script>
            $(document).ready(function() {
                $("#open").click(function() {
                    $.ajax({
                        url : "modellen/model.xml",
                        dataType: "text",
                        success : function (data) {
                            model = new evaluator_js.Model();
							model.parseBogusXMLString(data);
							$("#modelregels").val(model.modelregels);
							$("#startwaarden").val(model.startwaarden);
                            }
                        });
                });
            });
            </script>
        </div>



		<div>
			Number of iterations = <input type="text" id="NBox" value="1000">
			<p>
			Store <input type="text" id="NresultsBox" value="100"> iterations
			<p>
			<input id="run" type="button" value= "RUN!">
			<script>
			$(document).ready(function() {
				$("#run").click(function() {
					console.log('RUN! clicked.');

					// read model from textarea
					model = new evaluator_js.Model();
					model.modelregels = $("#modelregels").val();
					model.startwaarden = $("#startwaarden").val();
					console.log('model = ', model);

					// read N, Nresults from input fields
					var N = $('#NBox').val();
					var Nresults = $('#NresultsBox').val();
					console.log(N, Nresults);

					//run!
				    var evaluator = new evaluator_js.ModelregelsEvaluator(model, true);
					var results = evaluator.run(N, Nresults);
					var output_str = " DEBUG: t["+Nresults+"]= "+ results.t[Nresults-1]
					$("#status").html(output_str);
					console.log(output_str);

					// clean up, and print results
					var res = new evaluator_js.Results(evaluator.namespace);
					res.getAllandCleanUp(results);

					var table = 'Results:\n'
					table += 't [s]\ts [m] \tv [m/s] \n'
					for (var i=0; i < Nresults; i++) {
						table += res.t[i]+'\t'+res.s[i]+'\t'+res.v[i]+'\n';
					}
					$("#output").html(table);
				});
			});
		 	</script>
		</div>

		<p>
		<textarea id="modelregels"  rows=15 cols=40> Modelregels </textarea>
		<textarea id="startwaarden" rows=15 cols=25> Startwaarden </textarea>

	<div id="werkBlad">
		<pre id="status"></pre>
	</div>

	<div id="werkBlad">
		<pre id="output"></pre>
	</div>

	<!-- script/modules created with:
	     browserify SCRIPT.js -d -s SCRIPT_js -o /dist/SCRIPT_browserfied.js
		 access functions using SCRIPT_js object
	-->
	<script src="dist/evaluator.browser.js"></script>

</body>
</html>
